
<!DOCTYPE HTML>
<html lang="us-en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Introduction · containerd 英文文档</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-prism/prism-solarizedlight.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://docs.khs1994.com" target="_blank" class="custom-link">Home</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter active" data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Cri
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="cri/architecture.html">
            
                <a href="cri/architecture.html">
            
                    
                    Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="cri/config.html">
            
                <a href="cri/config.html">
            
                    
                    Config
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="cri/crictl.html">
            
                <a href="cri/crictl.html">
            
                    
                    Crictl
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="cri/decryption.html">
            
                <a href="cri/decryption.html">
            
                    
                    Decryption
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="cri/installation.html">
            
                <a href="cri/installation.html">
            
                    
                    Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="cri/registry.html">
            
                <a href="cri/registry.html">
            
                    
                    Registry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="cri/testing.html">
            
                <a href="cri/testing.html">
            
                    
                    Testing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Historical
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" >
            
                <span>
            
                    
                    Cri
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="historical/cri/proposal.html">
            
                <a href="historical/cri/proposal.html">
            
                    
                    Proposal
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" >
            
                <span>
            
                    
                    Design
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="historical/design/architecture.html">
            
                <a href="historical/design/architecture.html">
            
                    
                    Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="historical/design/data-flow.html">
            
                <a href="historical/design/data-flow.html">
            
                    
                    Data Flow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="historical/design/lifecycle.html">
            
                <a href="historical/design/lifecycle.html">
            
                    
                    Lifecycle
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="historical/design/mounts.html">
            
                <a href="historical/design/mounts.html">
            
                    
                    Mounts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.5" data-path="historical/design/snapshots.html">
            
                <a href="historical/design/snapshots.html">
            
                    
                    Snapshots
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" >
            
                <span>
            
                    
                    Reports
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="historical/reports/2017-01-13.html">
            
                <a href="historical/reports/2017-01-13.html">
            
                    
                    2017 01 13
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="historical/reports/2017-01-20.html">
            
                <a href="historical/reports/2017-01-20.html">
            
                    
                    2017 01 20
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="historical/reports/2017-01-27.html">
            
                <a href="historical/reports/2017-01-27.html">
            
                    
                    2017 01 27
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.4" data-path="historical/reports/2017-02-10.html">
            
                <a href="historical/reports/2017-02-10.html">
            
                    
                    2017 02 10
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.5" data-path="historical/reports/2017-02-24.html">
            
                <a href="historical/reports/2017-02-24.html">
            
                    
                    2017 02 24
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.6" data-path="historical/reports/2017-03-10.html">
            
                <a href="historical/reports/2017-03-10.html">
            
                    
                    2017 03 10
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.7" data-path="historical/reports/2017-03-17.html">
            
                <a href="historical/reports/2017-03-17.html">
            
                    
                    2017 03 17
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.8" data-path="historical/reports/2017-03-24.html">
            
                <a href="historical/reports/2017-03-24.html">
            
                    
                    2017 03 24
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.9" data-path="historical/reports/2017-04-28.html">
            
                <a href="historical/reports/2017-04-28.html">
            
                    
                    2017 04 28
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.10" data-path="historical/reports/2017-05-05.html">
            
                <a href="historical/reports/2017-05-05.html">
            
                    
                    2017 05 05
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.11" data-path="historical/reports/2017-05-19.html">
            
                <a href="historical/reports/2017-05-19.html">
            
                    
                    2017 05 19
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.12" data-path="historical/reports/2017-05-26.html">
            
                <a href="historical/reports/2017-05-26.html">
            
                    
                    2017 05 26
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.13" data-path="historical/reports/2017-06-09.html">
            
                <a href="historical/reports/2017-06-09.html">
            
                    
                    2017 06 09
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.14" data-path="historical/reports/2017-06-23.html">
            
                <a href="historical/reports/2017-06-23.html">
            
                    
                    2017 06 23
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Man
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="man/containerd-config.8.html">
            
                <a href="man/containerd-config.8.html">
            
                    
                    containerd-config.8
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="man/containerd-config.toml.5.html">
            
                <a href="man/containerd-config.toml.5.html">
            
                    
                    containerd-config.toml.5
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="snapshotters/">
            
                <a href="snapshotters/">
            
                    
                    Snapshotters
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="snapshotters/devmapper.html">
            
                <a href="snapshotters/devmapper.html">
            
                    
                    Devmapper
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="client-opts.html">
            
                <a href="client-opts.html">
            
                    
                    Client Opts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="content-flow.html">
            
                <a href="content-flow.html">
            
                    
                    Content Flow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="garbage-collection.html">
            
                <a href="garbage-collection.html">
            
                    
                    Garbage Collection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="getting-started.html">
            
                <a href="getting-started.html">
            
                    
                    Getting Started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="hosts.html">
            
                <a href="hosts.html">
            
                    
                    Hosts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="managed-opt.html">
            
                <a href="managed-opt.html">
            
                    
                    Managed Opt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="namespaces.html">
            
                <a href="namespaces.html">
            
                    
                    Namespaces
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="NRI.html">
            
                <a href="NRI.html">
            
                    
                    NRI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="ops.html">
            
                <a href="ops.html">
            
                    
                    Ops
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="PLUGINS.html">
            
                <a href="PLUGINS.html">
            
                    
                    PLUGINS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="remote-snapshotter.html">
            
                <a href="remote-snapshotter.html">
            
                    
                    Remote Snapshotter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="rootless.html">
            
                <a href="rootless.html">
            
                    
                    Rootless
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="RUNC.html">
            
                <a href="RUNC.html">
            
                    
                    RUNC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="stream_processors.html">
            
                <a href="stream_processors.html">
            
                    
                    Stream Processors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20" data-path="tracing.html">
            
                <a href="tracing.html">
            
                    
                    Tracing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21" data-path="transfer.html">
            
                <a href="transfer.html">
            
                    
                    Transfer
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Introduction</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p><img src="https://raw.githubusercontent.com/cncf/artwork/master/projects/containerd/horizontal/color/containerd-horizontal-color.png#gh-light-mode-only" alt="containerd banner light mode">
<img src="https://raw.githubusercontent.com/cncf/artwork/master/projects/containerd/horizontal/white/containerd-horizontal-white.png#gh-dark-mode-only" alt="containerd banner dark mode"></p>
<p><a href="https://pkg.go.dev/github.com/containerd/containerd" target="_blank"><img src="https://pkg.go.dev/badge/github.com/containerd/containerd" alt="PkgGoDev"></a>
<a href="https://github.com/containerd/containerd/actions?query=workflow%3ACI" target="_blank"><img src="https://github.com/containerd/containerd/workflows/CI/badge.svg" alt="Build Status"></a>
<a href="https://github.com/containerd/containerd/actions?query=workflow%3ANightly" target="_blank"><img src="https://github.com/containerd/containerd/workflows/Nightly/badge.svg" alt="Nightlies"></a>
<a href="https://goreportcard.com/report/github.com/containerd/containerd" target="_blank"><img src="https://goreportcard.com/badge/github.com/containerd/containerd" alt="Go Report Card"></a>
<a href="https://bestpractices.coreinfrastructure.org/projects/1271" target="_blank"><img src="https://bestpractices.coreinfrastructure.org/projects/1271/badge" alt="CII Best Practices"></a></p>
<p>containerd is an industry-standard container runtime with an emphasis on simplicity, robustness, and portability. It is available as a daemon for Linux and Windows, which can manage the complete container lifecycle of its host system: image transfer and storage, container execution and supervision, low-level storage and network attachments, etc.</p>
<p>containerd is a member of CNCF with <a href="https://landscape.cncf.io/?selected=containerd" target="_blank">&apos;graduated&apos;</a> status.</p>
<p>containerd is designed to be embedded into a larger system, rather than being used directly by developers or end-users.</p>
<p><img src="docs/historical/design/architecture.png" alt="architecture"></p>
<h2 id="announcements">Announcements</h2>
<h3 id="hello-kubernetes-v124">Hello Kubernetes v1.24!</h3>
<p>The containerd project would like to announce containerd <a href="https://github.com/containerd/containerd/releases/tag/v1.6.4" target="_blank">v1.6.4</a>. While other prior releases are supported, this latest release and the containerd <a href="https://github.com/containerd/containerd/releases/tag/v1.5.11" target="_blank">v1.5.11</a> release are recommended for Kubernetes v1.24.</p>
<p>We felt it important to announce this, particularly in view of <a href="https://kubernetes.io/blog/2022/05/03/dockershim-historical-context/" target="_blank">the dockershim removal from this release of Kubernetes</a>.</p>
<p>It should be noted here that moving to CRI integrations has been in the plan for many years.  <code>containerd</code> began as part of <code>Docker</code> and was donated to <code>CNCF</code>. <code>containerd</code> remains in use today by Docker/moby/buildkit etc., and has many other <a href="https://github.com/containerd/containerd/blob/main/ADOPTERS.md" target="_blank">adopters</a>. <code>containerd</code> has a namespace that isolates use of <code>containerd</code> from various clients/adopters. The Kubernetes namespace is appropriately named <code>k8s.io</code>. The CRI API and <code>containerd</code> CRI plugin project has, from the start, been an effort to reduce the impact surface for Kubernetes container runtime integration. If you can&apos;t tell, we are excited to see this come to fruition.</p>
<p>If you have any concerns or questions, we will be here to answer them in <a href="#communication">issues, discussions, and/or on slack</a>. Below you will find information/detail about our <a href="#cri">CRI Integration</a> implementation.</p>
<p>For containerd users already on v1.6.0-v1.6.3, there are known issues addressed by <a href="https://github.com/containerd/containerd/releases/tag/v1.6.4" target="_blank">v1.6.4</a>. The issues are primarily related to <a href="https://github.com/kubernetes/website/blob/dev-1.24/content/en/docs/tasks/administer-cluster/migrating-from-dockershim/troubleshooting-cni-plugin-related-errors.md" target="_blank">CNI setup</a></p>
<h3 id="now-recruiting">Now Recruiting</h3>
<p>We are a large inclusive OSS project that is welcoming help of any kind shape or form:</p>
<ul>
<li>Documentation help is needed to make the product easier to consume and extend.</li>
<li>We need OSS community outreach/organizing help to get the word out; manage
and create messaging and educational content; and help with social media, community forums/groups, and google groups.</li>
<li>We are actively inviting new <a href="https://github.com/containerd/project/blob/main/GOVERNANCE.md#security-advisors" target="_blank">security advisors</a> to join the team.</li>
<li>New subprojects are being created, core and non-core that could use additional development help.</li>
<li>Each of the <a href="https://github.com/containerd" target="_blank">containerd projects</a> has a list of issues currently being worked on or that need help resolving.<ul>
<li>If the issue has not already been assigned to someone or has not made recent progress, and you are interested, please inquire.</li>
<li>If you are interested in starting with a smaller/beginner-level issue, look for issues with an <code>exp/beginner</code> tag, for example <a href="https://github.com/containerd/containerd/issues?q=is%3Aissue+is%3Aopen+label%3Aexp%2Fbeginner" target="_blank">containerd/containerd beginner issues.</a></li>
</ul>
</li>
</ul>
<h2 id="getting-started">Getting Started</h2>
<p>See our documentation on <a href="https://containerd.io" target="_blank">containerd.io</a>:</p>
<ul>
<li><a href="docs/ops.md">for ops and admins</a></li>
<li><a href="docs/namespaces.md">namespaces</a></li>
<li><a href="docs/client-opts.md">client options</a></li>
</ul>
<p>See how to build containerd from source at <a href="BUILDING.md">BUILDING</a>.</p>
<p>If you are interested in trying out containerd see our example at <a href="docs/getting-started.md">Getting Started</a>.</p>
<h2 id="nightly-builds">Nightly builds</h2>
<p>There are nightly builds available for download <a href="https://github.com/containerd/containerd/actions?query=workflow%3ANightly" target="_blank">here</a>.
Binaries are generated from <code>main</code> branch every night for <code>Linux</code> and <code>Windows</code>.</p>
<p>Please be aware: nightly builds might have critical bugs, it&apos;s not recommended for use in production and no support provided.</p>
<h2 id="kubernetes-k8s-ci-dashboard-group">Kubernetes (k8s) CI Dashboard Group</h2>
<p>The <a href="https://testgrid.k8s.io/containerd" target="_blank">k8s CI dashboard group for containerd</a> contains test results regarding
the health of kubernetes when run against main and a number of containerd release branches.</p>
<ul>
<li><a href="https://testgrid.k8s.io/containerd-periodic" target="_blank">containerd-periodics</a></li>
</ul>
<h2 id="runtime-requirements">Runtime Requirements</h2>
<p>Runtime requirements for containerd are very minimal. Most interactions with
the Linux and Windows container feature sets are handled via <a href="https://github.com/opencontainers/runc" target="_blank">runc</a> and/or
OS-specific libraries (e.g. <a href="https://github.com/Microsoft/hcsshim" target="_blank">hcsshim</a> for Microsoft).
The current required version of <code>runc</code> is described in <a href="docs/RUNC.md">RUNC.md</a>.</p>
<p>There are specific features
used by containerd core code and snapshotters that will require a minimum kernel
version on Linux. With the understood caveat of distro kernel versioning, a
reasonable starting point for Linux is a minimum 4.x kernel version.</p>
<p>The overlay filesystem snapshotter, used by default, uses features that were
finalized in the 4.x kernel series. If you choose to use btrfs, there may
be more flexibility in kernel version (minimum recommended is 3.18), but will
require the btrfs kernel module and btrfs tools to be installed on your Linux
distribution.</p>
<p>To use Linux checkpoint and restore features, you will need <code>criu</code> installed on
your system. See more details in <a href="#checkpoint-and-restore">Checkpoint and Restore</a>.</p>
<p>Build requirements for developers are listed in <a href="BUILDING.md">BUILDING</a>.</p>
<h2 id="supported-registries">Supported Registries</h2>
<p>Any registry which is compliant with the <a href="https://github.com/opencontainers/distribution-spec" target="_blank">OCI Distribution Specification</a>
is supported by containerd.</p>
<p>For configuring registries, see <a href="docs/hosts.md">registry host configuration documentation</a></p>
<h2 id="features">Features</h2>
<h3 id="client">Client</h3>
<p>containerd offers a full client package to help you integrate containerd into your platform.</p>
<pre class="language-"><code class="lang-go">
<span class="token keyword">import</span> <span class="token punctuation">(</span>
  <span class="token string">&quot;context&quot;</span>

  <span class="token string">&quot;github.com/containerd/containerd&quot;</span>
  <span class="token string">&quot;github.com/containerd/containerd/cio&quot;</span>
  <span class="token string">&quot;github.com/containerd/containerd/namespaces&quot;</span>
<span class="token punctuation">)</span>


<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    client<span class="token punctuation">,</span> err <span class="token operator">:=</span> containerd<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;/run/containerd/containerd.sock&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">defer</span> client<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="namespaces">Namespaces</h3>
<p>Namespaces allow multiple consumers to use the same containerd without conflicting with each other.  It has the benefit of sharing content while maintaining separation with containers and images.</p>
<p>To set a namespace for requests to the API:</p>
<pre class="language-"><code class="lang-go">context <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// create a context for docker</span>
docker <span class="token operator">=</span> namespaces<span class="token punctuation">.</span><span class="token function">WithNamespace</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string">&quot;docker&quot;</span><span class="token punctuation">)</span>

containerd<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">NewContainer</span><span class="token punctuation">(</span>docker<span class="token punctuation">,</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
</code></pre>
<p>To set a default namespace on the client:</p>
<pre class="language-"><code class="lang-go">client<span class="token punctuation">,</span> err <span class="token operator">:=</span> containerd<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>address<span class="token punctuation">,</span> containerd<span class="token punctuation">.</span><span class="token function">WithDefaultNamespace</span><span class="token punctuation">(</span><span class="token string">&quot;docker&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="distribution">Distribution</h3>
<pre class="language-"><code class="lang-go"><span class="token comment">// pull an image</span>
image<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">Pull</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string">&quot;docker.io/library/redis:latest&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// push an image</span>
err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">Push</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string">&quot;docker.io/library/redis:latest&quot;</span><span class="token punctuation">,</span> image<span class="token punctuation">.</span><span class="token function">Target</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="containers">Containers</h3>
<p>In containerd, a container is a metadata object. Resources such as an OCI runtime specification, image, root filesystem, and other metadata can be attached to a container.</p>
<pre class="language-"><code class="lang-go">redis<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">NewContainer</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string">&quot;redis-master&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">defer</span> redis<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
</code></pre>
<h3 id="oci-runtime-specification">OCI Runtime Specification</h3>
<p>containerd fully supports the OCI runtime specification for running containers.  We have built-in functions to help you generate runtime specifications based on images as well as custom parameters.</p>
<p>You can specify options when creating a container about how to modify the specification.</p>
<pre class="language-"><code class="lang-go">redis<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">NewContainer</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string">&quot;redis-master&quot;</span><span class="token punctuation">,</span> containerd<span class="token punctuation">.</span><span class="token function">WithNewSpec</span><span class="token punctuation">(</span>oci<span class="token punctuation">.</span><span class="token function">WithImageConfig</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="root-filesystems">Root Filesystems</h3>
<p>containerd allows you to use overlay or snapshot filesystems with your containers.  It comes with built-in support for overlayfs and btrfs.</p>
<pre class="language-"><code class="lang-go"><span class="token comment">// pull an image and unpack it into the configured snapshotter</span>
image<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">Pull</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string">&quot;docker.io/library/redis:latest&quot;</span><span class="token punctuation">,</span> containerd<span class="token punctuation">.</span>WithPullUnpack<span class="token punctuation">)</span>

<span class="token comment">// allocate a new RW root filesystem for a container based on the image</span>
redis<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">NewContainer</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string">&quot;redis-master&quot;</span><span class="token punctuation">,</span>
    containerd<span class="token punctuation">.</span><span class="token function">WithNewSnapshot</span><span class="token punctuation">(</span><span class="token string">&quot;redis-rootfs&quot;</span><span class="token punctuation">,</span> image<span class="token punctuation">)</span><span class="token punctuation">,</span>
    containerd<span class="token punctuation">.</span><span class="token function">WithNewSpec</span><span class="token punctuation">(</span>oci<span class="token punctuation">.</span><span class="token function">WithImageConfig</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token comment">// use a readonly filesystem with multiple containers</span>
<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
    id <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;id-%s&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    container<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">NewContainer</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> id<span class="token punctuation">,</span>
        containerd<span class="token punctuation">.</span><span class="token function">WithNewSnapshotView</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> image<span class="token punctuation">)</span><span class="token punctuation">,</span>
        containerd<span class="token punctuation">.</span><span class="token function">WithNewSpec</span><span class="token punctuation">(</span>oci<span class="token punctuation">.</span><span class="token function">WithImageConfig</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="tasks">Tasks</h3>
<p>Taking a container object and turning it into a runnable process on a system is done by creating a new <code>Task</code> from the container.  A task represents the runnable object within containerd.</p>
<pre class="language-"><code class="lang-go"><span class="token comment">// create a new task</span>
task<span class="token punctuation">,</span> err <span class="token operator">:=</span> redis<span class="token punctuation">.</span><span class="token function">NewTask</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> cio<span class="token punctuation">.</span><span class="token function">NewCreator</span><span class="token punctuation">(</span>cio<span class="token punctuation">.</span>WithStdio<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">defer</span> task<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>

<span class="token comment">// the task is now running and has a pid that can be used to setup networking</span>
<span class="token comment">// or other runtime settings outside of containerd</span>
pid <span class="token operator">:=</span> task<span class="token punctuation">.</span><span class="token function">Pid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// start the redis-server process inside the container</span>
err <span class="token operator">:=</span> task<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>

<span class="token comment">// wait for the task to exit and get the exit status</span>
status<span class="token punctuation">,</span> err <span class="token operator">:=</span> task<span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
</code></pre>
<h3 id="checkpoint-and-restore">Checkpoint and Restore</h3>
<p>If you have <a href="https://criu.org/Main_Page" target="_blank">criu</a> installed on your machine you can checkpoint and restore containers and their tasks.  This allows you to clone and/or live migrate containers to other machines.</p>
<pre class="language-"><code class="lang-go"><span class="token comment">// checkpoint the task then push it to a registry</span>
checkpoint<span class="token punctuation">,</span> err <span class="token operator">:=</span> task<span class="token punctuation">.</span><span class="token function">Checkpoint</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>

err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">Push</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string">&quot;myregistry/checkpoints/redis:master&quot;</span><span class="token punctuation">,</span> checkpoint<span class="token punctuation">)</span>

<span class="token comment">// on a new machine pull the checkpoint and restore the redis container</span>
checkpoint<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">Pull</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string">&quot;myregistry/checkpoints/redis:master&quot;</span><span class="token punctuation">)</span>

redis<span class="token punctuation">,</span> err <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">NewContainer</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string">&quot;redis-master&quot;</span><span class="token punctuation">,</span> containerd<span class="token punctuation">.</span><span class="token function">WithNewSnapshot</span><span class="token punctuation">(</span><span class="token string">&quot;redis-rootfs&quot;</span><span class="token punctuation">,</span> checkpoint<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">defer</span> container<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>

task<span class="token punctuation">,</span> err <span class="token operator">=</span> redis<span class="token punctuation">.</span><span class="token function">NewTask</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> cio<span class="token punctuation">.</span><span class="token function">NewCreator</span><span class="token punctuation">(</span>cio<span class="token punctuation">.</span>WithStdio<span class="token punctuation">)</span><span class="token punctuation">,</span> containerd<span class="token punctuation">.</span><span class="token function">WithTaskCheckpoint</span><span class="token punctuation">(</span>checkpoint<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">defer</span> task<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>

err <span class="token operator">:=</span> task<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
</code></pre>
<h3 id="snapshot-plugins">Snapshot Plugins</h3>
<p>In addition to the built-in Snapshot plugins in containerd, additional external
plugins can be configured using GRPC. An external plugin is made available using
the configured name and appears as a plugin alongside the built-in ones.</p>
<p>To add an external snapshot plugin, add the plugin to containerd&apos;s config file
(by default at <code>/etc/containerd/config.toml</code>). The string following
<code>proxy_plugin.</code> will be used as the name of the snapshotter and the address
should refer to a socket with a GRPC listener serving containerd&apos;s Snapshot
GRPC API. Remember to restart containerd for any configuration changes to take
effect.</p>
<pre class="language-"><code>[proxy_plugins]
  [proxy_plugins.customsnapshot]
    type = &quot;snapshot&quot;
    address =  &quot;/var/run/mysnapshotter.sock&quot;
</code></pre><p>See <a href="docs/PLUGINS.md">PLUGINS.md</a> for how to create plugins</p>
<h3 id="releases-and-api-stability">Releases and API Stability</h3>
<p>Please see <a href="RELEASES.md">RELEASES.md</a> for details on versioning and stability
of containerd components.</p>
<p>Downloadable 64-bit Intel/AMD binaries of all official releases are available on
our <a href="https://github.com/containerd/containerd/releases" target="_blank">releases page</a>.</p>
<p>For other architectures and distribution support, you will find that many
Linux distributions package their own containerd and provide it across several
architectures, such as <a href="https://launchpad.net/ubuntu/bionic/+package/containerd" target="_blank">Canonical&apos;s Ubuntu packaging</a>.</p>
<h4 id="enabling-command-auto-completion">Enabling command auto-completion</h4>
<p>Starting with containerd 1.4, the urfave client feature for auto-creation of bash and zsh
autocompletion data is enabled. To use the autocomplete feature in a bash shell for example, source
the autocomplete/ctr file in your <code>.bashrc</code>, or manually like:</p>
<pre class="language-"><code>$ source ./contrib/autocomplete/ctr
</code></pre><h4 id="distribution-of-ctr-autocomplete-for-bash-and-zsh">Distribution of <code>ctr</code> autocomplete for bash and zsh</h4>
<p>For bash, copy the <code>contrib/autocomplete/ctr</code> script into
<code>/etc/bash_completion.d/</code> and rename it to <code>ctr</code>. The <code>zsh_autocomplete</code>
file is also available and can be used similarly for zsh users.</p>
<p>Provide documentation to users to <code>source</code> this file into their shell if
you don&apos;t place the autocomplete file in a location where it is automatically
loaded for the user&apos;s shell environment.</p>
<h3 id="cri">CRI</h3>
<p><code>cri</code> is a <a href="https://containerd.io/" target="_blank">containerd</a> plugin implementation of the Kubernetes <a href="https://github.com/kubernetes/cri-api/blob/master/pkg/apis/runtime/v1/api.proto" target="_blank">container runtime interface (CRI)</a>. With it, you are able to use containerd as the container runtime for a Kubernetes cluster.</p>
<p><img src="docs/cri/cri.png" alt="cri"></p>
<h4 id="cri-status">CRI Status</h4>
<p><code>cri</code> is a native plugin of containerd. Since containerd 1.1, the cri plugin is built into the release binaries and enabled by default.</p>
<blockquote>
<p><strong>Note:</strong> As of containerd 1.5, the <code>cri</code> plugin is merged into the containerd/containerd repo. For example, the source code previously stored under <a href="https://github.com/containerd/cri/tree/release/1.4/pkg" target="_blank"><code>containerd/cri/pkg</code></a>
was moved to <a href="https://github.com/containerd/containerd/tree/main/pkg/cri" target="_blank"><code>containerd/containerd/pkg/cri</code> package</a>.</p>
</blockquote>
<p>The <code>cri</code> plugin has reached GA status, representing that it is:</p>
<ul>
<li>Feature complete</li>
<li>Works with Kubernetes 1.10 and above</li>
<li>Passes all <a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-node/cri-validation.md" target="_blank">CRI validation tests</a>.</li>
<li>Passes all <a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-node/e2e-node-tests.md" target="_blank">node e2e tests</a>.</li>
<li>Passes all <a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-testing/e2e-tests.md" target="_blank">e2e tests</a>.</li>
</ul>
<p>See results on the containerd k8s <a href="https://k8s-testgrid.appspot.com/sig-node-containerd" target="_blank">test dashboard</a></p>
<h4 id="validating-your-cri-setup">Validating Your <code>cri</code> Setup</h4>
<p>A Kubernetes incubator project, <a href="https://github.com/kubernetes-sigs/cri-tools" target="_blank">cri-tools</a>, includes programs for exercising CRI implementations. More importantly, cri-tools includes the program <code>critest</code> which is used for running <a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-node/cri-validation.md" target="_blank">CRI Validation Testing</a>.</p>
<h4 id="cri-guides">CRI Guides</h4>
<ul>
<li><a href="contrib/ansible/README.md">Installing with Ansible and Kubeadm</a></li>
<li><a href="docs/getting-started.md">For Non-Ansible Users, Preforming a Custom Installation Using the Release Tarball and Kubeadm</a></li>
<li><a href="docs/cri/testing.md">CRI Plugin Testing Guide</a></li>
<li><a href="docs/cri/crictl.md">Debugging Pods, Containers, and Images with <code>crictl</code></a></li>
<li><a href="docs/cri/config.md">Configuring <code>cri</code> Plugins</a></li>
<li><a href="https://github.com/containerd/containerd/blob/main/docs/man/containerd-config.8.md" target="_blank">Configuring containerd</a></li>
</ul>
<h3 id="communication">Communication</h3>
<p>For async communication and long-running discussions please use issues and pull requests on the GitHub repo.
This will be the best place to discuss design and implementation.</p>
<p>For sync communication catch us in the <code>#containerd</code> and <code>#containerd-dev</code> Slack channels on Cloud Native Computing Foundation&apos;s (CNCF) Slack - <code>cloud-native.slack.com</code>. Everyone is welcome to join and chat. <a href="https://slack.cncf.io" target="_blank">Get Invite to CNCF Slack.</a></p>
<h3 id="security-audit">Security audit</h3>
<p>Security audits for the containerd project are hosted on our website. Please see the <a href="https://containerd.io/security/" target="_blank">security page at containerd.io</a> for more information.</p>
<h3 id="reporting-security-issues">Reporting security issues</h3>
<p>Please follow the instructions at <a href="https://github.com/containerd/project/blob/main/SECURITY.md#reporting-a-vulnerability" target="_blank">containerd/project</a></p>
<h2 id="licenses">Licenses</h2>
<p>The containerd codebase is released under the <a href="LICENSE">Apache 2.0 license</a>.
The README.md file and files in the &quot;docs&quot; folder are licensed under the
Creative Commons Attribution 4.0 International License. You may obtain a
copy of the license, titled CC-BY-4.0, at <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">http://creativecommons.org/licenses/by/4.0/</a>.</p>
<h2 id="project-details">Project details</h2>
<p><strong>containerd</strong> is the primary open source project within the broader containerd GitHub organization.
However, all projects within the repo have common maintainership, governance, and contributing
guidelines which are stored in a <code>project</code> repository commonly for all containerd projects.</p>
<p>Please find all these core project documents, including the:</p>
<ul>
<li><a href="https://github.com/containerd/project/blob/main/GOVERNANCE.md" target="_blank">Project governance</a>,</li>
<li><a href="https://github.com/containerd/project/blob/main/MAINTAINERS" target="_blank">Maintainers</a>,</li>
<li>and <a href="https://github.com/containerd/project/blob/main/CONTRIBUTING.md" target="_blank">Contributing guidelines</a></li>
</ul>
<p>information in our <a href="https://github.com/containerd/project" target="_blank"><code>containerd/project</code></a> repository.</p>
<h2 id="adoption">Adoption</h2>
<p>Interested to see who is using containerd? Are you using containerd in a project?
Please add yourself via pull request to our <a href="ADOPTERS.md">ADOPTERS.md</a> file.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Introduction","level":"1.1","depth":1,"next":{"title":"Cri","level":"1.2","depth":1,"ref":"","articles":[{"title":"Architecture","level":"1.2.1","depth":2,"path":"cri/architecture.md","ref":"cri/architecture.md","articles":[]},{"title":"Config","level":"1.2.2","depth":2,"path":"cri/config.md","ref":"cri/config.md","articles":[]},{"title":"Crictl","level":"1.2.3","depth":2,"path":"cri/crictl.md","ref":"cri/crictl.md","articles":[]},{"title":"Decryption","level":"1.2.4","depth":2,"path":"cri/decryption.md","ref":"cri/decryption.md","articles":[]},{"title":"Installation","level":"1.2.5","depth":2,"path":"cri/installation.md","ref":"cri/installation.md","articles":[]},{"title":"Registry","level":"1.2.6","depth":2,"path":"cri/registry.md","ref":"cri/registry.md","articles":[]},{"title":"Testing","level":"1.2.7","depth":2,"path":"cri/testing.md","ref":"cri/testing.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["-sharing","-highlight","-livereload","prism"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"prism":{"css":["prismjs/themes/prism-solarizedlight.css"]},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"containerd 英文文档","language":"us-en","links":{"sidebar":{"Home":"https://docs.khs1994.com"}},"gitbook":"*"},"file":{"path":"README.md","mtime":"2023-06-01T01:15:50.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2023-06-01T01:16:21.911Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

